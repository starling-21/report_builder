{% extends 'reports/base.html' %}

{#TEST include#}
{% include "django/forms/widgets/input.html" %}

{% block content %}
    <p>Edit servicemembers chain:</p>

    <form method="POST">{% csrf_token %}
        {% for servicemember in serviceman_chain %}

            {# editing chain member id, show input field for new chain member in chain members line #}
            {% if swap_id == servicemember.id %}
{#                <button disabled class="btn btn-light btn-sm"><span class="fas fa-edit"></span></button> {#chain editing button#}
                New servicemember:
                <input name="swap_id">
{#                <input type="hidden" name="old_id" value="{{ servicemember.id }}"/>#}

                <button type="submit" class="btn btn-light btn-sm" name="submit_new_id" value="{{ servicemember.id }}">
                    <span class="fas fa-check-square"></span> Ok</button> {#submit chain member id editing button#}
            {% elif swap_position_id == servicemember.position.id %}
                New servicemember position:
                <input type="checkbox" name="temporary" value="AAA">TBO<br>
                <input name="swap_position_id">
                <button type="submit" class="btn btn-light btn-sm" name="submit_new_position_id" value="{{ servicemember.position.id }}">
                    <span class="fas fa-check-square"></span> Ok</button> {#submit new position id button#}

            {% else %}
                {# --------------------------------------------- #}
                {# show normal chain member line with edit button#}
                <button disabled type="submit" class="btn btn-light btn-sm" name="remove_chain_id" value="{{ servicemember.id }}"><span class="far fa-trash-alt"></span></button>
                <button type="submit" class="btn btn-light btn-sm" name="edit_chain_id" value="{{ servicemember.id }}"><span class="fas fa-edit"></span></button>
                {{ servicemember.rank.name }} {{ servicemember }} : <br>
                <button type="submit" class="btn btn-light btn-sm" name="edit_position_id" value="{{ servicemember.position.id }}"><span class="fas fa-edit"></span></button>
                {{ servicemember.position }} <br>
            {% endif %}
            <hr>
            <hr>
        {% endfor %}

        <input type="submit" class="btn btn-info" name="submit_chain_editing" value="Next"/>
    </form>


{% endblock %}


{#block submitting form by pressing Enter button#}
{% block js_scripts %}
    <script type="text/javascript">
        window.addEventListener('keydown', function (e) {
            if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
                if (e.target.nodeName == 'INPUT' && e.target.type == 'text') {
                    e.preventDefault();
                    return false;
                }
            }
        }, true);
    </script>
{% endblock %}